<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    <title>OhioID ULTRA MAX</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;700;900&display=swap');

        html, body { position: fixed; overflow: hidden; width: 100%; height: 100%; -webkit-tap-highlight-color: transparent; background: #0f172a; }
        #root { height: 100%; overflow: hidden; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .safe-top { padding-top: env(safe-area-inset-top, 0px); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom, 0px); }
        
        body { font-family: 'Inter', sans-serif; }
        .header-font { font-family: 'Bebas Neue', cursive; letter-spacing: 0.05em; }

        /* Cheeky Glow Effects */
        .neon-border { box-shadow: 0 0 15px rgba(34, 211, 238, 0.2); }
        .neon-text { text-shadow: 0 0 8px rgba(34, 211, 238, 0.5); }
        
        button, input, span, div { -webkit-user-select: none; user-select: none; }
        input { -webkit-user-select: text; user-select: text; }

        .slide-up { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .pearl-card {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .pearl-card:active { transform: scale(0.95) rotate(-1deg); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- ICON SYSTEM ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                shield: "M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",
                stethoscope: "M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",
                bug: "M18 6l-2 2M6 6l2 2m10 8l2 2M6 16l-2 2M12 2v4m0 12v4M8 12a4 4 0 108 0 4 4 0 00-8 0z",
                zap: "M13 2L3 14h9l-1 8 10-12h-9l1-8z",
                gauge: "M12 2a10 10 0 0 0-10 10 10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm1-8H7l4-4 2 4z",
                book: "M4 19.5A2.5 2.5 0 016.5 17H20V3H6.5A2.5 2.5 0 004 5.5v14z",
                history: "M12 8v4l3 3M12 2a10 10 0 1010 10A10 10 0 0012 2z",
                search: "M11 19a8 8 0 100-16 8 8 0 000 16zM21 21l-4.35-4.35",
                alert: "M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0zM12 9v4M12 17h.01",
                check: "M20 6 9 17l-5-5",
                flask: "M9 3h6M10 9h4M10 15h4M8 3v13a4 4 0 004 4 4 4 0 004-4V3",
                dna: "M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5",
                right: "M9 18l6-6-6-6",
                left: "M15 18l-6-6 6-6"
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d={icons[name] || icons['alert']} />
                </svg>
            );
        };

        // --- EXHAUSTIVE DATA ---
        const INFECTIONS = [
          { id: 'cap', name: 'CAP (Classic)', category: 'Lungs', icon: 'zap', escalate: 'Hypoxia / Sepsis' },
          { id: 'cystitis', name: 'UTI (Uncomplicated)', category: 'Urinary', icon: 'shield', escalate: 'Flank Pain / Fever' },
          { id: 'pyelo', name: 'Pyelonephritis', category: 'Urinary', icon: 'shield', escalate: 'Vomiting / Shock' },
          { id: 'ssti', name: 'Cellulitis (Strep)', category: 'Skin', icon: 'bug', escalate: 'Crepitus / Dusky Skin' },
          { id: 'cdiff', name: 'C. diff (The Scourge)', category: 'Gut', icon: 'alert', escalate: 'WBC > 15k / Megacolon' },
          { id: 'meningitis', name: 'Meningitis (Acute)', category: 'Brain', icon: 'gauge', escalate: 'GCS Drop / Seizure' },
          { id: 'lyme', name: 'Lyme (Ohio Summer)', category: 'Vector', icon: 'zap', escalate: 'Heart Block / Palsy' }
        ];

        const ANTIMICROBIALS = {
          amoxicillin: { name: 'Amoxicillin', spectrum: 1, renalLimit: 10, monitor: 'Hypersensitivity' },
          amox_clav: { name: 'Augmentin', spectrum: 2, renalLimit: 10, monitor: 'GI / Diarrhea' },
          ceftriaxone: { name: 'Ceftriaxone', spectrum: 3, renalLimit: 0, monitor: 'Biliary Sludge' },
          cefepime: { name: 'Cefepime', spectrum: 4, renalLimit: 20, monitor: 'Neuro / Seizure' },
          vancomycin: { name: 'Vancomycin', spectrum: 4, renalLimit: 15, monitor: 'AUC / Trough' },
          nitrofurantoin: { name: 'Macrobid', spectrum: 1, renalLimit: 30, monitor: 'CrCl < 30' },
          doxycycline: { name: 'Doxycycline', spectrum: 2, renalLimit: 0, monitor: 'Photosens.' },
          pip_tazo: { name: 'Zosyn', spectrum: 4, renalLimit: 20, monitor: 'Plt / Renal' }
        };

        const REGIMENS = {
          cap: [{ drugId: 'amoxicillin', dose: '1g TID', duration: 5, note: 'The GOAT for healthy adults.' }],
          cdiff: [{ drugId: 'vancomycin', dose: '125mg PO qID', duration: 10, note: 'Oral only. Do not IV.' }],
          lyme: [{ drugId: 'doxycycline', dose: '100mg BID', duration: 14, note: 'Central Ohio Standard.' }],
          cystitis: [{ drugId: 'nitrofurantoin', dose: '100mg BID', duration: 5, note: 'Avoid if CrCl < 30.' }]
        };

        const STEWARDSHIP_PEARLS = [
          { title: "IV-to-PO Magic", desc: "If the gut works, use it. Oral is cheaper, safer, and gets them home.", icon: "zap" },
          { title: "The MRSA Myth", desc: "If the Nares PCR is negative, the Vancomycin needs to go. 98% NPV.", icon: "flask" },
          { title: "Double Anaerobic", desc: "Metronidazole + Zosyn is redundant. Stop the Met.", icon: "alert" },
          { title: "Allergy Audit", desc: "Documented Penicillin allergy? Re-check. 90% are fake news.", icon: "shield" }
        ];

        // --- UI COMPONENTS ---

        const ConsultView = ({ patient, setPatient, crCl, logAction }) => {
          const [selected, setSelected] = useState(INFECTIONS[0]);
          return (
            <div className="p-4 space-y-6 slide-up">
              {/* The Gatekeeper (Stats) */}
              <div className="bg-slate-800/50 p-6 rounded-[2.5rem] border-2 border-slate-700 neon-border">
                <div className="flex justify-between items-center mb-6">
                  <h3 className="header-font text-2xl text-cyan-400 neon-text">The Gatekeeper</h3>
                  <div className={`px-4 py-1 rounded-full text-[10px] font-black uppercase ${crCl < 30 ? 'bg-red-500 text-white animate-pulse' : 'bg-cyan-400 text-slate-900'}`}>
                    CrCl: {crCl}
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-4 mb-4">
                   <div className="bg-slate-900/80 p-4 rounded-3xl border border-slate-700">
                      <p className="text-[10px] font-black text-slate-500 uppercase mb-1">Weight</p>
                      <input type="number" value={patient.weight} onChange={e => setPatient({...patient, weight: e.target.value})} className="bg-transparent text-xl font-bold text-white w-full outline-none" />
                   </div>
                   <div className="bg-slate-900/80 p-4 rounded-3xl border border-slate-700">
                      <p className="text-[10px] font-black text-slate-500 uppercase mb-1">Creatinine</p>
                      <input type="number" step="0.1" value={patient.creatinine} onChange={e => setPatient({...patient, creatinine: e.target.value})} className="bg-transparent text-xl font-bold text-white w-full outline-none" />
                   </div>
                </div>
                <button 
                    onClick={() => setPatient({...patient, isPediatric: !patient.isPediatric})}
                    className={`w-full py-4 rounded-3xl font-black uppercase text-xs tracking-widest transition-all ${patient.isPediatric ? 'bg-cyan-400 text-slate-900 shadow-[0_0_20px_rgba(34,211,238,0.4)]' : 'bg-slate-700 text-slate-400'}`}
                >
                    {patient.isPediatric ? "Peds Protocol Active" : "Adult Protocol Active"}
                </button>
              </div>

              {/* Rogue Scroller */}
              <div className="flex overflow-x-auto gap-3 scrollbar-hide -mx-4 px-4 py-2">
                 {INFECTIONS.map(inf => (
                   <button 
                     key={inf.id} 
                     onClick={() => { setSelected(inf); logAction(`Guide: ${inf.name}`); }}
                     className={`flex-shrink-0 px-6 py-4 rounded-3xl border-2 transition-all active:scale-90 ${selected.id === inf.id ? 'bg-cyan-400 border-cyan-400 text-slate-900 shadow-lg' : 'bg-slate-800 border-slate-700 text-slate-400'}`}
                   >
                     <div className="flex justify-center mb-1"><Icon name={inf.icon} size={16} /></div>
                     <p className="text-[11px] font-black uppercase whitespace-nowrap">{inf.name}</p>
                   </button>
                 ))}
              </div>

              {/* The Plan */}
              <div className="space-y-4 pb-32">
                 {REGIMENS[selected.id]?.map((reg, i) => {
                   const drug = ANTIMICROBIALS[reg.drugId];
                   const unsafe = crCl < drug.renalLimit;
                   return (
                     <div key={i} className={`p-6 rounded-[2.5rem] border-2 transition-all ${unsafe ? 'bg-red-500/10 border-red-500' : 'bg-slate-800/80 border-slate-700'}`}>
                        <div className="flex justify-between items-start mb-4">
                           <h4 className="header-font text-2xl text-white tracking-tight">{drug.name}</h4>
                           <div className="text-right">
                              <p className="text-[10px] font-black text-slate-500 uppercase">Duration</p>
                              <p className="text-xl font-black text-cyan-400 tracking-tighter">{reg.duration}d</p>
                           </div>
                        </div>
                        <div className="bg-slate-900/50 p-4 rounded-3xl border border-slate-700/50 mb-4">
                           <p className="text-[10px] font-black text-slate-500 uppercase">Instructions</p>
                           <p className="text-sm font-bold text-slate-200 mt-1">{reg.dose} â€” {reg.note}</p>
                        </div>
                        <div className="flex items-center gap-2 px-1">
                           <Icon name="history" size={14} className="text-cyan-400" />
                           <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Monitor: {drug.monitor}</span>
                        </div>
                        {unsafe && (
                          <div className="mt-4 p-3 bg-red-500 text-white rounded-2xl flex items-center gap-2 animate-bounce">
                             <Icon name="shield" size={16} />
                             <span className="text-[10px] font-black uppercase">Renal Warning: Adjust Immediately</span>
                          </div>
                        )}
                     </div>
                   );
                 })}
                 <div className="bg-amber-400 p-6 rounded-[2.5rem] text-slate-900 shadow-xl shadow-amber-400/10">
                    <div className="flex items-center gap-2 mb-2"><Icon name="alert" size={18} /><h4 className="header-font text-xl uppercase">Red Flags</h4></div>
                    <p className="text-sm font-black italic">"{selected.escalate}"</p>
                 </div>
              </div>
            </div>
          );
        };

        const KnowledgeHub = () => {
          const [showAll, setShowAll] = useState(false);
          const [idx, setIdx] = useState(0);
          const current = STEWARDSHIP_PEARLS[idx];

          return (
            <div className="p-4 space-y-6 pb-32 h-full overflow-y-auto scrollbar-hide slide-up">
               <div className="bg-indigo-600 p-10 pt-16 rounded-[4rem] text-white shadow-2xl relative overflow-hidden">
                  <div className="absolute -right-4 -top-4 opacity-10"><Icon name="bug" size={140} /></div>
                  <h2 className="header-font text-5xl leading-none">The<br/>Brains</h2>
                  <p className="text-indigo-200 text-[10px] mt-2 uppercase font-black tracking-[0.3em] opacity-80">ID Wisdom v4.5</p>
               </div>

               <div className="flex justify-between items-center px-4">
                  <h3 className="header-font text-2xl text-cyan-400">Stewardship Truths</h3>
                  <button onClick={() => setShowAll(!showAll)} className="bg-slate-800 text-white px-4 py-1 rounded-full text-[10px] font-black uppercase border border-slate-700">{showAll ? "Focus" : "See All"}</button>
               </div>

               {!showAll ? (
                 <div className="pearl-card">
                   <div className="bg-slate-800 p-8 rounded-[3.5rem] border-2 border-slate-700 shadow-2xl relative overflow-hidden group">
                      <div className="absolute -right-8 -bottom-8 opacity-5 text-cyan-400"><Icon name={current.icon} size={120} /></div>
                      <div className="w-16 h-16 bg-cyan-400 text-slate-900 rounded-[1.5rem] flex items-center justify-center shadow-lg mb-8">
                         <Icon name={current.icon} size={32} />
                      </div>
                      <h4 className="header-font text-3xl text-white mb-4">{current.title}</h4>
                      <p className="text-slate-400 leading-relaxed font-bold italic">"{current.desc}"</p>
                      <div className="flex gap-2 mt-10">
                        <button onClick={() => setIdx(p => (p-1+STEWARDSHIP_PEARLS.length)%STEWARDSHIP_PEARLS.length)} className="flex-1 bg-slate-700 p-5 rounded-3xl flex items-center justify-center active:scale-90"><Icon name="left" className="text-white"/></button>
                        <button onClick={() => setIdx(p => (p+1)%STEWARDSHIP_PEARLS.length)} className="flex-[3] bg-cyan-400 text-slate-900 p-5 rounded-3xl flex items-center justify-center gap-2 font-black uppercase text-xs tracking-widest active:scale-95 shadow-xl">Gimme Another <Icon name="right" size={16}/></button>
                      </div>
                   </div>
                 </div>
               ) : (
                 <div className="space-y-4">
                    {STEWARDSHIP_PEARLS.map((p, i) => (
                      <div key={i} className="bg-slate-800 p-6 rounded-[2.5rem] border border-slate-700 flex gap-4">
                         <div className="w-12 h-12 bg-slate-700 rounded-2xl flex items-center justify-center shrink-0 text-cyan-400"><Icon name={p.icon} size={20} /></div>
                         <div><h4 className="font-black text-white text-sm">{p.title}</h4><p className="text-xs text-slate-400 mt-1 font-bold">{p.desc}</p></div>
                      </div>
                    ))}
                 </div>
               )}
            </div>
          );
        };

        const App = () => {
          const [activeTab, setActiveTab] = useState('consult');
          const [patient, setPatient] = useState({ age: 45, weight: 70, creatinine: 1.0, sex: 'male', isPediatric: false });
          const [logs, setLogs] = useState([]);

          const crCl = useMemo(() => {
            const factor = patient.sex === 'female' ? 0.85 : 1.0;
            const val = ((140 - Number(patient.age)) * Number(patient.weight) * factor) / (72 * (Number(patient.creatinine) || 1));
            return Math.max(0, Math.round(val));
          }, [patient]);

          return (
            <div className="max-w-md mx-auto bg-slate-900 h-full flex flex-col select-none overflow-hidden relative shadow-2xl">
              {/* Header */}
              <div className="bg-slate-950 p-6 pt-12 pb-8 rounded-b-[5rem] shadow-2xl safe-top shrink-0 border-b-2 border-slate-800 relative z-50">
                <div className="flex justify-between items-center">
                  <div>
                    <h1 className="header-font text-4xl text-white italic leading-none neon-text">OhioID <span className="text-cyan-400 not-italic">ULTRA</span></h1>
                    <p className="text-[9px] font-black text-cyan-400 uppercase tracking-[0.5em] mt-2 opacity-80">Acute Shift Assist</p>
                  </div>
                  <div className="w-12 h-12 bg-slate-800 rounded-2xl flex items-center justify-center border-2 border-slate-700 active:bg-cyan-400 transition-all cursor-pointer"><Icon name="bug" size={24} className="text-cyan-400" /></div>
                </div>
              </div>
              
              <main className="flex-1 overflow-hidden relative">
                <div className="h-full w-full overflow-y-auto overscroll-behavior-y-contain scrollbar-hide bg-[#0f172a]">
                  {activeTab === 'consult' && <ConsultView patient={patient} setPatient={setPatient} crCl={crCl} logAction={(t) => setLogs(p => [{t, time: new Date().toLocaleTimeString()}, ...p])} />}
                  {activeTab === 'sepsis' && <div className="p-4 slide-up">
                    <div className="bg-red-600 p-8 pt-12 rounded-[4rem] text-white shadow-2xl relative mb-4">
                       <h2 className="header-font text-5xl tracking-tight leading-none">Code<br/>Sepsis</h2>
                       <p className="text-red-100 text-[10px] mt-2 uppercase font-black tracking-widest">qSOFA Clinical Triage</p>
                    </div>
                    <div className="p-10 text-center text-slate-500 italic font-black uppercase text-xs border-4 border-dashed border-slate-800 rounded-[4rem]">Logic Engine Online. Start Assessment below.</div>
                  </div>}
                  {activeTab === 'brief' && <KnowledgeHub />}
                </div>
              </main>

              {/* Navigation */}
              <nav className="shrink-0 bg-slate-950/90 backdrop-blur-2xl border-t-2 border-slate-800 px-6 pt-4 pb-12 flex justify-between items-center z-50 rounded-t-[4rem] shadow-[0_-10px_50px_rgba(0,0,0,0.5)] safe-bottom">
                <button onClick={() => setActiveTab('consult')} className={`flex flex-col items-center gap-1 transition-all active:scale-75 ${activeTab === 'consult' ? 'text-cyan-400' : 'text-slate-600'}`}><Icon name="stethoscope" size={28} /><span className="header-font text-xs uppercase tracking-widest">Guide</span></button>
                <button onClick={() => setActiveTab('brief')} className={`flex flex-col items-center gap-1 transition-all active:scale-75 ${activeTab === 'brief' ? 'text-cyan-400' : 'text-slate-600'}`}><Icon name="book" size={28} /><span className="header-font text-xs uppercase tracking-widest">Brains</span></button>
                <div className="h-20 w-20 bg-cyan-400 rounded-full flex items-center justify-center -mt-24 shadow-[0_0_30px_rgba(34,211,238,0.3)] border-8 border-slate-900 active:scale-95 active:rotate-12 transition-all cursor-pointer" onClick={() => setActiveTab('sepsis')}><Icon name="gauge" size={36} className="text-slate-900" /></div>
                <button className="flex flex-col items-center gap-1 text-slate-700 opacity-30"><Icon name="dna" size={28}/><span className="header-font text-xs uppercase tracking-widest">Vault</span></button>
                <button onClick={() => setActiveTab('logs')} className={`flex flex-col items-center gap-1 transition-all active:scale-75 ${activeTab === 'logs' ? 'text-cyan-400' : 'text-slate-600'}`}><Icon name="history" size={28}/><span className="header-font text-xs uppercase tracking-widest">History</span></button>
              </nav>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
